<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>E-Voting 2.0 | Election Commissioner</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 font-sans">

<div class="flex min-h-screen">

  <!-- Sidebar -->
  <aside class="w-64 bg-white border-r min-h-screen p-6 relative">
    <h1 class="text-xl font-bold text-green-600 mb-6">Election Commissioner</h1>
    <nav class="space-y-3">
      <a href="#" class="block p-2 rounded hover:bg-gray-100">Dashboard</a>
      <a href="#election-section" class="block p-2 rounded hover:bg-gray-100">Election</a>
      <a href="#voters-section" class="block p-2 rounded hover:bg-gray-100">Voter Management</a>
      <a href="#candidates-section" class="block p-2 rounded hover:bg-gray-100">Candidates</a>
    </nav>
    <div class="absolute bottom-6">
      <a href="#" class="text-red-500 flex items-center"><span class="material-icons mr-2">logout</span>Logout</a>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-6 space-y-6">

    <!-- Dashboard Overview -->
    <section class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <div class="bg-white p-4 rounded shadow">
        <p class="text-gray-500">Election Name</p>
        <h3 class="text-2xl font-bold">{{ election.name if election else 'Not Created' }}</h3>
      </div>
      <div class="bg-white p-4 rounded shadow">
        <p class="text-gray-500">Registered Voters</p>
        <h3 class="text-2xl font-bold">{{ total_voters }}</h3>
      </div>
      <div class="bg-white p-4 rounded shadow">
        <p class="text-gray-500">Votes Cast</p>
        <h3 class="text-2xl font-bold">{{ votes_cast }}</h3>
      </div>
      <div class="bg-white p-4 rounded shadow">
        <p class="text-gray-500">Status</p>
        <h3 class="text-2xl font-bold">
          {% if election %}
            {{ election.status }}
          {% else %}
            Not Created
          {% endif %}
        </h3>
      </div>
    </section>

    <!-- Election Section -->
    <section id="election-section">
      <h2 class="text-xl font-bold mb-4">Election</h2>
      {% if not election %}
      <div class="bg-white p-4 rounded shadow">
        <form method="POST" action="/create-election" class="space-y-4">
          <div>
            <label class="block text-gray-700">Election Name</label>
            <input type="text" name="name" required class="w-full border p-2 rounded"/>
          </div>
          <div>
            <label class="block text-gray-700">Start Date & Time</label>
            <input type="datetime-local" name="start_date" required class="w-full border p-2 rounded"/>
          </div>
          <div>
            <label class="block text-gray-700">End Date & Time</label>
            <input type="datetime-local" name="end_date" required class="w-full border p-2 rounded"/>
          </div>
          <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded hover:opacity-90">Create Election</button>
        </form>
      </div>
      {% else %}
      <div class="bg-white p-4 rounded shadow">
        <p class="text-gray-700">Election is already created.</p>
        <p class="mt-2"><strong>Election Name:</strong> {{ election.name }}</p>
        <p><strong>Start:</strong> {{ election.start_date }}</p>
        <p><strong>End:</strong> {{ election.end_date }}</p>
        {% if election.status == 'Ended' %}
          <p><strong>Winner:</strong> {{ election.winner }}</p>
        {% endif %}
      </div>
      {% endif %}
    </section>

    <!-- Voter Management -->
    <section id="voters-section">
      <h2 class="text-xl font-bold mb-4">Voter Management</h2>
      <div class="bg-white p-4 rounded shadow mb-4">
        <form method="POST" action="/add-voter" class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <input type="text" name="name" placeholder="Voter Name" required class="border p-2 rounded"/>
          <input type="email" name="email" placeholder="Voter Email" required class="border p-2 rounded"/>
          <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:opacity-90">Add Voter</button>
        </form>
      </div>

      <div class="bg-white p-4 rounded shadow overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-2 border-b">Voter Name</th>
              <th class="px-4 py-2 border-b">Email</th>
              <th class="px-4 py-2 border-b">Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for voter in voters %}
            <tr>
              <td class="px-4 py-2 border-b">{{ voter.name }}</td>
              <td class="px-4 py-2 border-b">{{ voter.email }}</td>
              <td class="px-4 py-2 border-b">
                <form method="POST" action="/remove-voter/{{ voter.id }}">
                  <button type="submit" class="bg-red-500 text-white px-2 py-1 rounded text-sm">Remove</button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>

    <!-- Candidate Management -->
    <section id="candidates-section">
      <h2 class="text-xl font-bold mb-4">Candidate Management</h2>
      <div class="bg-white p-4 rounded shadow mb-4">
        <form method="POST" action="/add-candidate" enctype="multipart/form-data" class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <input type="text" name="name" placeholder="Candidate Name" required class="border p-2 rounded"/>
          <input type="text" name="party" placeholder="Party Name" required class="border p-2 rounded"/>
          <input type="text" name="moto" placeholder="Moto / Slogan" class="border p-2 rounded"/>
          <input type="file" name="profile_pic" class="border p-2 rounded"/>
          <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded hover:opacity-90 col-span-full md:col-span-1">Add Candidate</button>
        </form>
      </div>

      <div class="bg-white p-4 rounded shadow overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-4 py-2 border-b">Name</th>
              <th class="px-4 py-2 border-b">Party</th>
              <th class="px-4 py-2 border-b">Moto</th>
              <th class="px-4 py-2 border-b">Profile Picture</th>
            </tr>
          </thead>
          <tbody>
            {% for candidate in candidates %}
            <tr>
              <td class="px-4 py-2 border-b">{{ candidate.name }}</td>
              <td class="px-4 py-2 border-b">{{ candidate.party }}</td>
              <td class="px-4 py-2 border-b">{{ candidate.moto }}</td>
              <td class="px-4 py-2 border-b">
                {% if candidate.profile_pic %}
                  <img src="{{ candidate.profile_pic }}" alt="Profile" class="h-10 w-10 rounded-full"/>
                {% else %}
                  N/A
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>

  </main>
</div>

</body>
</html>